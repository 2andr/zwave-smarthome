<!-- Rooms view -->
<div ng-controller="RoomController">
    <bb-loader></bb-loader>
    <div class="page-control form-inline">
        <a class="btn btn-default s-hide" href="#config-rooms/0" ng-if="elementAccess(cfg.role_access.config_rooms)">
            <i class="fa fa-plus text-success"></i>
            <span class="btn-name">{{_t('lb_add_room')}}</span>
        </a>
        <div class="input-group input-search s-hide">
            <input type="text" ng-model="q" class="form-control form-search" value="{{q}}">
            <span class="input-group-addon"><i class="fa fa-search"></i></span>
        </div>
    </div>

    <!-- The list -->
    <!--<pre>{{rooms.all | json }}</pre>-->
    <div class="clearfix" ng-if="rooms.show" ng-controller="ElementBaseController">
        <div class="card-room longpress-{{longPressSent}}"
             id="card_{{v.id}}"
             ng-click="redirectToRoute('rooms' + (rooms.cnt.devices[v.id] ? '/' + v.id : ''))"
             ng-class="rooms.cnt.devices[v.id] ? 'room-has-device' : 'room-no-device'"
             ng-hide="v.id === 0 && !rooms.cnt.devices[v.id]"
             ng-repeat="v in rooms.all|orderBy:cfg.orderby.rooms[rooms.orderBy] | filter:q  track by $index">
            <div class="card-room-in" style="background-image: url('{{v.img_src}}');" 
                 on-long-press="onLongPress(v.id)"
                 on-touch-end="onTouchEnd()"
                 prevent-click="true">
                <!-- Card header -->
                <div class="card-header">

                    <a class="card-icon lg" href="#config-rooms/{{v.id}}" title="{{_t('lb_update')}}"
                       ng-show="elementAccess(cfg.role_access.config_rooms) && v.id != 0">
                        <i class="fa fa-cog"></i>
                    </a>
                    <span class="card-icon sm" ng-show="elementAccess(cfg.role_access.config_rooms)">
                        {{v.title_char}}
                    </span>
                </div>
                <!-- Card icons -->


                <!-- Card content -->
                <div class="card-footer">
                    <!-- Card title -->
                    <h3 class="card-title" title="{{v.title}}">
                        <a ng-href="#/rooms{{(rooms.cnt.devices[v.id] ? '/' + v.id : '')}}"
                           ng-disabled="!rooms.cnt.devices[v.id]" title="{{_t('lb_devices_room')}} {{v.title}}">
                            {{v.title|cutText:true:25}}
                            <span class="item-cnt">({{rooms.cnt.devices[v.id]|| 0}})</span>
                        </a>
                    </h3>
                    <!-- Card sensors -->
                    <div class="card-sensors" ng-show="v.main_sensors.length > 0">
                        <div class="sensor" title="{{device.metrics.title + ': ' + device.metrics.level + ' ' + device.metrics.scaleTitle}}"
                             ng-show="v.main_sensors.indexOf(device.id) > -1"
                             ng-repeat="device in dataHolder.devices.all">
                            <div class="sensor-img">
                                <img class="sensor-preview-img img-circle" ng-src="{{device.iconPath}}" alt="img">
                            </div>
                            <div class="sensor-ctrl">
                                <span class="sensor-level">{{device.metrics.level}}</span>
                                <span class="sensor-scale">{{device.metrics.scaleTitle|cutText:true:7}}</span>
                                &nbsp;
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- Button for mobile devices -->
    <div class="text-center l-hide">
         <a class="btn btn-default btn" href="#config-rooms/0">
        <i class="fa fa-plus text-success"></i>
        <span class="btn-name_">{{_t('lb_add_room')}}</span>
    </a>
    </div>
   
</div> <!-- /ng-controller -->
