<!-- The scene -->
<div ng-controller="AutomationRuleIdController">

  <h2>{{_t('rules')}}</h2>
  <!-- Form -->
  <form class="form form-page" ng-submit="storeRule(rule.input,true)">
    <!-- Form-->
    <fieldset ng-include="'app/views/automation/rules/rule_id_form.html'"></fieldset>
    <!-- ////////////////////////////////////////// tabs  ////////////////////////////////////////// -->
    <fieldset ng-if="!rule.input.params.advanced.activate">
      <div class="tabs-wrap form-inline" bind-class-on-scroll offset="50" scroll-class="fix-me-top">
        <div class="btn-group btn-group-justified btn-goup-tabs">
          <a class="btn btn-default" title="{{_t('if')}}" ng-class="{'active':rule.tab == 'if'}" ng-click="rule.tab = 'if'">
            {{_t('if')}}
          </a>
          <a class="btn btn-default" title="{{_t('then')}}" ng-class="{'active':rule.tab == 'then'}" ng-click="rule.tab = 'then'">
            {{_t('then')}}
          </a>
          <a class="btn btn-default" title="{{_t('else')}}" ng-class="{'active':rule.tab == 'else'}" ng-click="rule.tab = 'else'">
            {{_t('else')}}
          </a>
        </div>
      </div>

    </fieldset>
    <div ng-if="!rule.input.params.advanced.activate">
      <!-- ////////////////////////////////////////// if  ////////////////////////////////////////// -->
       <!-- Assigned -->
       <div ng-if="_.size(rule.source.selected.device)">
          <legend>{{_t('assigned_devices')}}</legend>
          <fieldset ng-include="'app/views/automation/rules/rule_id_if_assigned.html'"></fieldset>
        </div>
      <!-- Available -->
      <legend>{{_t('lb_available_devices')}}</legend>
      <fieldset ng-if="rule.tab == 'if'" ng-include="'app/views/automation/rules/rule_id_if_available.html'"></fieldset>
      <!--  ////////////////////////////////////////// then  ////////////////////////////////////////// -->
      <fieldset ng-if="rule.tab == 'then'" ng-include="'app/views/automation/rules/rule_id_then.html'"></fieldset>
      <div ng-if="rule.tab == 'then'">
        <!-- Assigned -->
        <div ng-if="_.size(rule.input.params.targets.elements)">
          <legend>{{_t('assigned_devices')}}</legend>
          <fieldset ng-include="'app/views/automation/rules/rule_id_then_assigned.html'"></fieldset>
        </div>
        <!-- Available -->
        <legend>{{_t('lb_available_devices')}}</legend>
        <fieldset ng-include="'app/views/automation/rules/rule_id_then_available.html'"></fieldset>
      </div>
      <!--  ////////////////////////////////////////// else  ////////////////////////////////////////// -->
      <fieldset ng-if="rule.tab == 'else'" ng-include="'app/views/automation/rules/rule_id_else.html'"></fieldset>
    </div>
    <!--  ////////////////////////////////////////// advanced  ////////////////////////////////////////// -->
    <!-- <legend ng-click="expandElement('ruleAdvanced')">
        <input type="checkbox" name="advanced_activate" id="advanced_activate" ng-model="rule.input.params.advanced.activate" ng-checked="rule.input.params.advanced.activate" /> <label for="advanced_activate">{{_t('Use advanced settings')}}</label>
        </legend>
    <fieldset ng-if="rule.input.params.advanced.activate" ng-include="'app/views/automation/rules/rule_id_advanced.html'"></fieldset> -->
    <!--  ////////////////////////////////////////// submit  ////////////////////////////////////////// -->
    <fieldset class="submit-entry">
      <button type="button" class="btn btn-default" title="{{_t('lb_cancel')}}" bb-go-back>
        <i class="fa fa-reply"></i>
        <span class="btn-name">{{_t('lb_cancel')}}</span>
      </button>
      <button type="submit" title="{{_t('lb_save')}}" class="btn btn-submit">
        <i class="fa fa-check"></i>
        <span class="btn-name">{{_t('lb_save')}}</span>
      </button>
    </fieldset>
  </form>
  <!-- <pre>{{rule.input|json}}</pre>
  <pre>{{rule.source.selected|json}}</pre> -->
</div>
<!-- /ng-controller -->